% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CAIScore.R
\name{CAIScore}
\alias{CAIScore}
\title{Compute Cellular Activity Integration Score (CAIScore)}
\usage{
CAIScore(
  expr,
  geneset,
  scaling = c("zscore", "minmax", "none"),
  summary_method = c("mean", "sum", "median"),
  auc_nCores = 1,
  kcdf_type = c("Gaussian", "Poisson"),
  AMS_nbin = 10
)
}
\arguments{
\item{expr}{A Seurat object (with \code{SCT} or \code{RNA} assay) or a numeric gene expression matrix with gene symbols as row names and samples/cells as column names.}

\item{geneset}{A gene set or a list of gene sets used for scoring. Acceptable formats include:
\itemize{
\item A character vector (representing a single gene set),
\item A named list of character vectors (multiple gene sets).
}}

\item{scaling}{Character string indicating the scaling method to apply to the individual algorithm scores before integration. Options:
\itemize{
\item \code{"zscore"}: Z-score normalization across cells/samples,
\item \code{"minmax"}: Rescale scores to the range \link{0, 1},
\item \code{"none"}: No scaling (raw scores used).
}}

\item{summary_method}{Character string specifying how to aggregate scores from the five methods. Options:
\itemize{
\item \code{"mean"} (default),
\item \code{"sum"},
\item \code{"median"}.
}}

\item{auc_nCores}{Integer. Number of CPU cores to use in AUCell calculation. Default is 1.}

\item{kcdf_type}{Character string specifying the kernel type for ssGSEA via GSVA. Options:
\itemize{
\item \code{"Gaussian"}: Suitable for normalized expression data,
\item \code{"Poisson"}: Recommended for raw count data.
}}

\item{AMS_nbin}{Integer, number of bins used in Seurat::AddModuleScore (default: 24).
Useful to reduce this (e.g. to 10) when sample size is small to avoid cut_number errors.}
}
\value{
If \code{expr} is a Seurat object, returns the object with added metadata columns for each individual score and the final integrated \code{CAIScore}.
If \code{expr} is a matrix, returns a \code{data.frame} containing one row per sample/cell with scores from all five methods and the final integrated score.
}
\description{
This function calculates a composite score named \strong{CAIScore} based on five widely-used gene set scoring algorithms
— AUCell, UCell, singscore, ssGSEA, and AddModuleScore — to assess biological signal intensity at the single-cell or sample level.
It supports both Seurat objects and gene expression matrices, and allows for flexible scaling and summarization strategies.

This function supports both Seurat objects and standard gene expression matrices, providing a standardized, scalable, and reproducible framework for quantifying gene set activity.
By integrating multiple orthogonal scoring algorithms, it enables robust gene signature evaluation across diverse transcriptomic contexts
—particularly in single-cell or bulk RNA-seq analyses where consistent and interpretable quantification of biological pathways or functional modules is essential.
}
\details{
The \strong{CAIScore} is derived by integrating the outputs from five orthogonal gene signature scoring methods:
\itemize{
\item \strong{AUCell}: Area Under the Curve-based method evaluating gene set enrichment in ranked expression profiles.
\item \strong{UCell}: A rank-based, normalization-agnostic signature scoring approach optimized for single-cell data.
\item \strong{singscore}: Uses relative ranks of gene expression to compute signature scores in an unbiased, reproducible manner.
\item \strong{ssGSEA} (via GSVA): Computes single-sample GSEA scores based on expression-level integration.
\item \strong{AddModuleScore}: Seurat-native module scoring function for evaluating predefined gene sets.
}

The aggregated CAIScore enhances signal robustness by leveraging the strengths of each algorithm. It offers a unified score that better reflects biological activity across diverse transcriptomic contexts.
}
\examples{
# Example 1: Using a Seurat object
data("pbmc_small")
geneset <- list(Tcell_Signature = c("CD3D", "CD3E", "CD3G"))
pbmc_small <- CAIScore(
  expr = pbmc_small,
  geneset = geneset,
  scaling = "zscore",
  summary_method = "mean",
  auc_nCores = 2,
  kcdf_type = "Gaussian"
)

# Example 2: Using an expression matrix
mat <- matrix(rnorm(1000), nrow = 100)
rownames(mat) <- paste0("Gene", 1:100)
colnames(mat) <- paste0("Sample", 1:10)
geneset <- list(CustomSet = paste0("Gene", 1:10))
score_result <- CAIScore(
  expr = mat,
  geneset = geneset,
  scaling = "minmax",
  summary_method = "sum",
  auc_nCores = 4,
  kcdf_type = "Gaussian"
)

}
\seealso{
\code{\link{AUCell}},
\code{\link{UCell}},
\code{\link{gsva}},
\code{\link{singscore}},
\code{\link[Seurat]{AddModuleScore}}
}
\author{
Algorithm design: Ruiqiu Chen
Package development and integration: Ruiqiu Chen
}
